## TCP/IP

## TCP/UDP

- TCP（Transmission Control Protocol，传输控制协议）
  - 是面向连接的协议，也就是说，在收发数据前，必须和对方建立可靠的连接。 一个TCP连接必须要经过三次“对话”才能建立起来
- UDP
  - 是一个非连接的协议，传输数据之前源端和终端不建立连接， 当它想传送时就简单地去抓取来自应用程序的数据，并尽可能快地把它扔到网络上。 
  - 一台服务机可同时向多个客户机传输相同的消息。

### 应用场景

- TCP：发信息，文件传输
- UDP：视频聊天，直播

### 区别

- TCP有连接，UDP无连接
- TCP一对一，UDP一对多
- TCP包头的最小长度为20字节, TCP包头为8字节。
- TCP面向连接，UDP面向报文
- TCP保证数据正确性，UDP可能丢包
- TCP保证数据顺序，UDP不保证

### TCP三次握手

- 第一次握手：主机A通过向主机B发送一个含有同步序列号的标志位的数据段给主机B，向主机B 请求建立连接，通过这个数据段， 主机A告诉主机B 两件事：我想要和你通信；你可以用哪个序列号作为起始数据段来回应我。

- 第二次握手：主机B 收到主机A的请求后，用一个带有确认应答（ACK）和同步序列号（SYN）标志位的数据段响应主机A，也告诉主机A两件事：我已经收到你的请求了，你可以传输数据了；你要用那个序列号作为起始数据段来回应我

- 第三次握手：主机A收到这个数据段后，再发送一个确认应答，确认已收到主机B 的数据段："我已收到回复，我现在要开始传输实际数据了，这样3次握手就完成了，主机A和主机B 就可以传输数据了。

### TCP四次挥手

- 第一次： 当主机A完成数据传输后,将控制位FIN置1，提出停止TCP连接的请求 ；
- 第二次： 主机B收到FIN后对其作出响应，确认这一方向上的TCP连接将关闭,将ACK置1；
- 第三次： 由B 端再提出反方向的关闭请求,将FIN置1 ；
- 第四次： 主机A对主机B的请求进行确认，将ACK置1，双方向的关闭结束.。

### 名词解释

- ACK 是TCP报头的控制位之一，对数据进行确认。确认由接收端发出， 用它来告诉发送端这个序列号之前的数据段都收到了。 比如确认号为X，则表示前X-1个数据段都收到了，只有当ACK=1时,确认号才有效，当ACK=0时，确认号无效，这时会要求重传数据，保证数据的完整性。
- SYN 同步序列号，TCP建立连接时将这个位 置1。
- FIN 发送端完成发送任务位，当TCP完成数据传输需要断开时,，提出断开连接的一方将这位置1。

## 状态码

- 304(未修改)：自从上次请求后，请求的网页未修改过。服务器返回此响应时，不会返回网页内容。如果网页自请求者上次请求后再也没有更改过，您应将服务器配置为返回此响应(称为 If-Modified-Since HTTP 标头)。服务器可以告诉 Googlebot 自从上次抓取后网页没有变更，进而节省带宽和开销。
  - 如果服务器有变更，则从服务器重新下载，返回状态码200
- 500（服务器内部错误）：服务器遇到错误，无法完成请求
- 501（尚未实施）：服务器不具备完成请求的功能
- 502（错误网关）：作为网关或者代理工作的服务器尝试执行请求时，从上游服务器接收到无效的响应。
- 503（服务不可用）：作为网关或者代理工作的服务器尝试执行请求时，未能及时从上游服务器（URI标识出的服务器，例如HTTP、FTP、LDAP）或者辅助服务器（例如DNS）收到响应。
- 504（网关超时）：服务器作为网关或代理，未及时从上游服务器接收请求
- 505（HTTP 版本不受支持）： 服务器不支持请求中所使用的 HTTP 协议版本。

## 协议

### ARP

- IP --> MAC
- 在TCP/IP中属于网络层，在OSI中属于数据链路层

### SSl（Https加密协议）四次握手

## 7层模型和5层模型

- 七层：应用层-表示层-会话层-传输层-网络层-数据链路层-物理层
- 五层：应用层-传输层-网络层-数据链路层-物理层

## DNS寻址

### 什么是DNS

- DNS就是域名系统，是因特网中的一项核心服务，是用于实现域名和IP地址相互映射的一个分布式数据库，能够使用户更方便的访问互联网，而不用去记住能够被机器直接读取的IP地址。通过主机名，得到该主机名对应的IP地址的过程叫做域名解析

### 解析过程

- 向浏览器输入一个域名，然后浏览器发起一个DNS解析请求，如果在本地缓存服务器中找不到，则向根服务器查询，根服务器会返回域名对应的顶级域服务器的位置信息
- 拿到顶级域服务器的位置信息后，就会去询问顶级域服务器，查找对应域名服务器的地址
- 拿到服务器地址后，查询域名，返回ip地址，缓存到本地服务器中
- 进入http的链接，顺利访问网站

## 路由转发

### 原理

- 二层转发：MAC地址表，广播可能有偶环路，STP防止，同一个VLAN实现
- 三层转发：路由表，静态路由配置错误有环路，TTL和路由协议解决



