# MySQL

## 索引设计原则

- 针对数据量大，查询频繁的表需要建立索引
- 对经常需要作为查询条件，排序，分组的字段建立索引
- 对区分度高的字段建立索引，尽量建唯一索引
- 尽量使用联合索引，并满足最左前缀法则，联合索引很多时候可以覆盖索引，节省存储空间，避免回表，提高查询效率
- 索引不是越多越好，会影响增删改效率
- 不能为可以为null的字段建立索引，需要使用 not null 约束，当优化器知道每列是否包含null值时，它可以更好的确定哪个索引最有效的用于查询

## 索引失效

- 没有满足最左前缀法则，跳过其中某一列则其之后索引失效
- 联合索引中使用了 > < ，（>=，<=不会失效）
- like “%xx”（左模糊）
- 字符串没加引号
- or两端有一端没有索引
- MySQL评估走全表更快时
- 索引的字段进行运算时

## 索引的优化

- 对较长的字符型字段建立前缀索引
  - `create Index on 表名(字段(长度))`
  - 前缀的长度的大小最好是：
    -  按前缀长度去重后的数量 / 总数量
    -  越接近1越好
- 使用 `force index` 强制使用索引
- 查询的字段尽量覆盖索引，减少 select * 的使用